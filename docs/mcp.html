<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MCP (Model Context Protocol) - AbstractCore</title>
    <meta name="description" content="AbstractCore treats MCP as a tool-server protocol (not an LLM provider).">
    <link rel="icon" type="image/svg+xml" href="../assets/logo.svg">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="../assets/css/main.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css" rel="stylesheet">

    <!-- Navbar Component -->
    <script src="../assets/js/navbar-component.js"></script>
</head>
<body>
    <!-- Navigation -->
    <div class="navbar-placeholder"></div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            createNavbar({
                basePath: '',
                menuItems: [{'text': 'Features', 'href': '/docs/capabilities.html'}, {'text': 'Quick Start', 'href': '/docs/getting-started.html'}, {'text': 'Documentation', 'href': '/#docs'}, {'text': 'Examples', 'href': '/docs/examples.html'}, {'text': 'GitHub', 'href': 'https://github.com/lpalbou/abstractcore', 'target': '_blank', 'icon': 'github'}, {'text': 'PyPI', 'href': 'https://pypi.org/project/abstractcore/', 'target': '_blank', 'icon': 'pypi'}]
            });
        });
    </script>

    <!-- Main Content -->
    <main style="padding-top: 5rem;">
        <div class="container" style="max-width: 1100px;">
            <div class="doc-header" style="margin-bottom: 3rem;">
                <h1 style="font-size: 2.5rem; margin-bottom: 1rem;">MCP (Model Context Protocol)</h1>
                <p style="font-size: 1.25rem; color: var(--text-secondary);">AbstractCore treats MCP as a tool-server protocol (not an LLM provider).</p>
            </div>

            <div style="background: var(--background-secondary); padding: 2rem; border-radius: 0.75rem; margin-bottom: 3rem;"><h2 style="margin: 0 0 1rem 0;">Table of Contents</h2><a href="#what-you-can-do-today" style="display: block; padding: 0.4rem 0; color: var(--primary-color);">What you can do today</a>
<a href="#transports-supported" style="display: block; padding: 0.4rem 0; color: var(--primary-color);">Transports supported</a>
<a href="#configuration-helpers" style="display: block; padding: 0.4rem 0; color: var(--primary-color);">Configuration helpers</a>
<a href="#current-limitations" style="display: block; padding: 0.4rem 0; color: var(--primary-color);">Current limitations</a></div>

            <div class="doc-content">


<p>The <code>abstractcore.mcp</code> module provides:
- a minimal MCP JSON-RPC client (Streamable HTTP) → <code>abstractcore.mcp.McpClient</code>
- a minimal MCP stdio client (spawn a subprocess) → <code>abstractcore.mcp.McpStdioClient</code>
- tool discovery (<code>tools/list</code>) and conversion into AbstractCore tool specs → <code>abstractcore.mcp.McpToolSource</code></p>
<h2 id="what-you-can-do-today">What you can do today</h2>
<h3 id="1-discover-tools-from-an-mcp-server">1) Discover tools from an MCP server</h3>
<div class="code-block"><pre><code class="language-python">from abstractcore.mcp import McpClient, McpToolSource

client = McpClient(url="http://localhost:3000")  # MCP streamable HTTP endpoint
source = McpToolSource(server_id="local", client=client)
tools = source.list_tool_specs()
</code></pre></div>
<p>Each returned tool spec is an AbstractCore-compatible dict you can pass to <code>tools=[...]</code> in
<code>generate()</code>/<code>agenerate()</code>. Tool names are namespaced as:</p>
<p><code>mcp::&lt;server_id&gt;::&lt;tool_name&gt;</code></p>
<p>See <code>abstractcore/abstractcore/mcp/naming.py</code>.</p>
<h3 id="2-execute-mcp-tools-in-your-hostruntime">2) Execute MCP tools in your host/runtime</h3>
<p>AbstractCore’s default execution path is <strong>passthrough</strong> (<code>execute_tools=False</code>): the model can
request tool calls and you execute them in your host/runtime.</p>
<p>The built-in <code>abstractcore.tools.registry.execute_tools()</code> executes Python callables registered in
the (deprecated) global registry; it does <strong>not</strong> automatically route MCP tool calls. For MCP, your
host/runtime should detect names starting with <code>mcp::</code> and dispatch them to an MCP client.</p>
<div class="code-block"><pre><code class="language-python">from abstractcore.mcp import McpClient, parse_namespaced_tool_name

client = McpClient(url="http://localhost:3000")

def execute_mcp_tool_call(call: dict) -&gt; dict:
    parsed = parse_namespaced_tool_name(call.get("name", ""))
    if not parsed:
        raise ValueError("Not an MCP tool call")
    server_id, tool_name = parsed
    return client.call_tool(name=tool_name, arguments=call.get("arguments") or {})
</code></pre></div>
<h2 id="transports-supported">Transports supported</h2>
<h3 id="streamable-http">Streamable HTTP</h3>
<p><code>McpClient</code> posts JSON-RPC to the server URL. It automatically sets an <code>Accept</code> header compatible
with streamable HTTP (<code>application/json, text/event-stream</code>) and will capture <code>MCP-Session-Id</code>
responses when provided.</p>
<p>See <code>abstractcore/abstractcore/mcp/client.py</code>.</p>
<h3 id="stdio">stdio</h3>
<p><code>McpStdioClient</code> spawns an MCP server subprocess and communicates over stdin/stdout with JSON-RPC,
including a best-effort initialization handshake.</p>
<p>See <code>abstractcore/abstractcore/mcp/stdio_client.py</code>.</p>
<h2 id="configuration-helpers">Configuration helpers</h2>
<p><code>create_mcp_client(config=...)</code> supports both HTTP and stdio config shapes:</p>
<div class="code-block"><pre><code class="language-python">from abstractcore.mcp import create_mcp_client

client = create_mcp_client(config={"url": "http://localhost:3000"})
client = create_mcp_client(config={"transport": "stdio", "command": ["my-mcp-server", "--stdio"]})
</code></pre></div>
<p>See <code>abstractcore/abstractcore/mcp/factory.py</code>.</p>
<h2 id="current-limitations">Current limitations</h2>
<ul>
<li>MCP is currently a <strong>library-level</strong> integration (tool discovery + clients). AbstractCore’s HTTP
  server does not expose MCP management endpoints.</li>
<li>Tool execution routing for <code>mcp::...</code> names is host/runtime responsibility.</li>
</ul>
            </div>
        </div>
    </main>

    <!-- Scripts -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script src="../assets/js/main.js"></script>
</body>
</html>
